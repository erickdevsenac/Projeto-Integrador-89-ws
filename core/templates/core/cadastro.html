{% extends 'global/base.html' %}
{% load static %}

{% block cadastro %}
{% block head %}
  <title>Cadastro Usuário</title>
  <link rel="stylesheet" href="{% static 'core/stylecadastro.css' %}">
{% endblock head %}

<div class="body">
  <div class="container-fluid">
    <div class="logo">
      <img src="{% static 'assets/img/logo.png' %}" alt="">
      <h1>APROVEITE+</h1>
    </div>

    <div class="caixa">
      <h2>Cadastro de Usuário</h2>

      <form method="post" action="">
        {% csrf_token %}

        {% if form.non_field_errors %}
          <div class="form-errors">
            {% for error in form.non_field_errors %}
              <p style="color: red;">{{ error }}</p>
            {% endfor %}
          </div>
        {% endif %}

        <div class="form-group">
            {{ form.tipo.label_tag }}
            {{ form.tipo }}
            {% if form.tipo.errors %}
                <div class="field-errors">
                    {% for error in form.tipo.errors %}
                        <p style="color: red;">{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
        
        <div id="campos-comuns">
            <div class="form-group">{{ form.nome_negocio.label_tag }} {{ form.nome_negocio }}</div>
            <div class.form-group>{{ form.email.label_tag }} {{ form.email }}</div>
            <div class="form-group">{{ form.senha.label_tag }} {{ form.senha }}</div>
            <div class="form-group">{{ form.confirmar_senha.label_tag }} {{ form.confirmar_senha }}</div>
            <div class="form-group">{{ form.telefone.label_tag }} {{ form.telefone }}</div>
            <div class="form-group">{{ form.endereco.label_tag }} {{ form.endereco }}</div>
        </div>
        
        <div id="campos-parceiro" style="display:none;">
            <div class="form-group">{{ form.cnpj.label_tag }} {{ form.cnpj }}</div>
            <div class="form-group">{{ form.descricao_parceiro.label_tag }} {{ form.descricao_parceiro }}</div>
        </div>

        <button type="submit" class="botao botao-verde">Cadastrar</button>
      </form>
    </div>
  </div>
</div>

<script>
  // Função para mostrar/ocultar campos com base no tipo de usuário
  function mostrarCamposParceiro() {
    // Django gera o ID como "id_nome_do_campo"
    const tipo = document.getElementById('id_tipo').value;
    const camposParceiro = document.getElementById('campos-parceiro');

    // Mostra os campos se for VENDEDOR ou ONG
    if (tipo === 'VENDEDOR' || tipo === 'ONG') {
      camposParceiro.style.display = 'block';
    } else {
      camposParceiro.style.display = 'none';
    }
  }

  // Adiciona o 'listener' para chamar a função quando o valor do select mudar
  document.getElementById('id_tipo').addEventListener('change', mostrarCamposParceiro);

  // Chama a função uma vez no carregamento da página para garantir que o estado inicial esteja correto
  // (útil se o formulário for recarregado com um tipo já selecionado após um erro)
  document.addEventListener('DOMContentLoaded', mostrarCamposParceiro);
</script>



{% endblock cadastro %}
