{% extends 'global/base.html' %}
{% load static %}



{% block criareceita %}

{% block head %}
  <title>Cadastrar Nova Receita - Aproveite+</title>
  <link rel="stylesheet" href={% static "core/css/style_cria_receita.css" %}>
{% endblock head %}

<div class="container mt-5 mb-5">
    <h2 class="form-title">Cadastrar Nova Receita</h2>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Formulário Principal da Receita -->
        <fieldset class="mb-4">
            <legend>Informações da Receita</legend>
            {{ form.as_p }}
        </fieldset>
        
        <hr>

        <!-- Ingredientes (Formset) -->
        <div class="formset-container">
            <legend>Ingredientes</legend>
            {{ ingrediente_formset.management_form }}

            <div id="ingredientes-form-list">
                {% for form in ingrediente_formset %}
                    <div class="formset-item">
                        {{ form.as_p }}
                        <button type="button" class="remove-formset-row">Remover</button>
                    </div>
                {% endfor %}
            </div>

            <div id="empty-ingredientes-form" class="d-none">
                <div class="formset-item">
                    {{ ingrediente_formset.empty_form.as_p }}
                    <button type="button" class="remove-formset-row">Remover</button>
                </div>
            </div>

            <button type="button" id="add-ingredientes" class="add-formset-row">
                <i class="bi bi-plus-circle"></i> Adicionar Ingrediente
            </button>
        </div>

        <!-- Etapas (Formset) -->
        <div class="formset-container">
            <legend>Modo de Preparo</legend>
            {{ etapa_formset.management_form }}

            <div id="etapas-form-list">
                {% for form in etapa_formset %}
                    <div class="formset-item">
                        {{ form.as_p }}
                        <button type="button" class="remove-formset-row">Remover</button>
                    </div>
                {% endfor %}
            </div>

            <div id="empty-etapas-form" class="d-none">
                <div class="formset-item">
                    {{ etapa_formset.empty_form.as_p }}
                    <button type="button" class="remove-formset-row">Remover</button>
                </div>
            </div>

            <button type="button" id="add-etapas" class="add-formset-row">
                <i class="bi bi-plus-circle"></i> Adicionar Etapa
            </button>
        </div>

        <!-- Botão de envio -->
        <div class="d-grid gap-2 mt-4">
            <button type="submit" class="btn btn-primary btn-lg">Salvar Receita</button>
        </div>
    </form>
</div>

<!-- Script para lidar com os formsets dinamicamente -->
<script src="{% static 'core/js/criareceita.js' %}"></script>

{% endblock %}
