{% extends 'global/base.html' %}
{% load static %}

{% block head %}
  <title>Carrinho de Compras</title>
  <link rel="stylesheet" href="{% static 'core/css/style_carrinho.css' %}">
    {% endblock head %}

{% block content %}
<div class="container-fluid">
  <header>
    <h1 class="titulo-carrinho">Bem-Vindo Ao Seu Carrinho de Compras</h1>
    <p>O momento é agora. Garanta seu sonho antes que acabe!!</p>
  </header>

  <main>
    <section class="carrinho-compras">

      {% if carrinho %}
        <form id="cart-form" method="post" action="#"> {% csrf_token %}

          {% for item in carrinho %}
            <div class="produto-item">
              <input type="checkbox" name="selecionados" value="{{ item.produto_id }}">
              
              <img src="{{ item.imagem_url }}" alt="{{ item.nome }}">
              
              <div class="detalhes-produto">
                <h3>{{ item.nome }}</h3>
                <h4>Vendedor: {{ item.vendedor_nome }}</h4>
                <span>R${{ item.preco|floatformat:2 }}</span>
                
                <div class="mt-2">
                  <input type="number" class="form-control form-control-sm" value="{{ item.quantidade }}" min="1" name="quantidade_{{ item.produto_id }}" style="max-width: 100px;">
                </div>
              </div>
            </div>
          {% endfor %}

          <div class="total-display" id="total">
            Total: R$0,00
          </div>
    
          <div class="d-flex justify-content-end gap-3">
            <button type="submit" class="btn btn-outline-danger">Remover Selecionados</button>
            <a href="{% url 'core:finalizar_pedido' %}" class="btn btn-primary">Finalizar Compra</a>
          </div>
        </form>

      {% else %}
        <div class="text-center p-5">
            <h3>Seu carrinho está vazio.</h3>
            <p class="lead text-muted">Que tal adicionar alguns produtos incríveis?</p>
            <a href="{% url 'core:produtos' %}" class="btn btn-primary mt-3">Ver Produtos</a>
        </div>
      {% endif %}

    </section>
  </main>
</div>
    <script defer src={% static "core/js/carrinho.js" %} ></script>

{% endblock content %}